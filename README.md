# ‚õìÔ∏è VeriChain: Full-Stack 2-Factor Wallet Authentication

A complete, full-stack web application demonstrating a secure, two-factor authentication (2FA) flow. It combines a traditional email/password login (1st factor) with a cryptographic wallet signature (2nd factor), also known as "Sign-in with Ethereum".

This project is a **monorepo** containing both the React frontend and the Node.js backend.

---

## ‚ú® Core Features

* **Hybrid Authentication:** Registers users by linking a secure password to a specific public wallet address (e.g., MetaMask).
* **True 2-Factor Security:**
    1.  **Factor 1:** Verifies identity with a correct email and password.
    2.  **Factor 2:** Proves wallet ownership by requiring a signature for a unique, one-time message (nonce) generated by the backend.
* **Protected Routes:** The user dashboard is fully secure. Unauthorized users are instantly redirected to the login page.
* **Secure Session Management:** Uses JSON Web Tokens (JWT) to authorize all API requests after login.
* **Database Logging:** All successful, verified logins are recorded in a MongoDB database.
* **Dynamic Dashboard:** Users can view their personal login history, which is securely fetched from the backend.

---

## üõ†Ô∏è Tech Stack

This project is built with the MERN stack and web3 technologies.

### 1. Frontend (`/frontend`)

* **React:** A JavaScript library for building user interfaces.
* **Tailwind CSS:** A utility-first CSS framework for rapid UI development.
* **Ethers.js:** Connects to the browser's MetaMask wallet to get wallet addresses and sign messages.
* **React Router:** Handles client-side routing and protected routes.
* **`react-hot-toast`:** Provides clean, simple notifications.

### 2. Backend (`/backend`)

* **Node.js:** A JavaScript runtime for the server.
* **Express:** A minimal and flexible Node.js web application framework.
* **MongoDB (Mongoose):** The database used to store the persistent login history.
* **JSON Web Tokens (JWT):** Used to create secure session tokens for authenticating API requests.
* **Ethers.js:** Used on the backend to cryptographically verify wallet signatures.
* **`crypto`:** A built-in Node.js module used to generate secure, random nonces.

---

## ‚öôÔ∏è How the Authentication Flow Works

The login process is a two-step "challenge-response" flow.



1.  **Login (Factor 1):** The user submits their email and password. The backend checks them. If correct, it sends back the user's *required wallet address*.
2.  **Redirect to Verify:** The frontend moves to the `/verify` page.
3.  **Nonce Request (The "Challenge"):** The frontend asks the backend for a challenge (`/request-nonce`). The backend generates a unique, one-time random string (a **nonce**) and saves it.
4.  **Sign Message:** The backend sends the nonce to the frontend, which prompts MetaMask to sign it. The user's private key creates a unique **signature**.
5.  **Verification (The "Response"):** The frontend sends the signature to the backend (`/verify-signature`).
6.  **Comparison:** The backend uses `ethers.js` to compare the *original nonce* with the *signature*. It recovers the wallet address that signed it.
7.  **Success:** If the recovered address matches the user's stored address, the backend:
    * Saves the login to the **MongoDB** history.
    * Creates a **JWT** session token.
    * Sends the token to the frontend.
8.  **Access Granted:** The frontend saves the JWT and redirects the user to the secure `/dashboard`.

---

## üöÄ How to Run This Project

You will need to run both the frontend and backend in two separate terminals.

### Prerequisites

* Node.js (v18 or later)
* **MongoDB Community Server** installed and **running** on your computer.
* **MetaMask** browser extension.

### 1. Backend Setup

1.  **Open a terminal** and navigate to the backend folder:
    ```sh
    cd backend
    ```
2.  **Install dependencies:**
    ```sh
    npm install
    ```
3.  **Create your environment file:**
    * Create a new file named `.env` in the `/backend` folder.
    * Paste in the following and add your own values:

    ```
    # A strong, random string for signing your JWTs
    JWT_SECRET=YOUR_SUPER_SECRET_KEY_HERE

    # Your local MongoDB connection string (change the db name)
    MONGODB_URI=mongodb://127.0.0.1:27017/verichain_db
    ```

4.  **Run the server:**
    ```sh
    node index.js
    ```
    *(Your backend will now be running at `http://localhost:3000`)*

### 2. Frontend Setup

1.  **Open a *second* terminal** and navigate to the frontend folder:
    ```sh
    cd frontend
    ```
2.  **Install dependencies:**
    ```sh
    npm install
    ```
3.  **Run the app:**
    ```sh
    npm run dev
    ```
    *(Your frontend will now be running at `http://localhost:5173`)*

You can now open `http://localhost:5173` in your browser to use the application.
